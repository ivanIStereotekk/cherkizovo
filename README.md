# Задание для черкизово:

Задание
1. Необходимо создать таблицу на сервере MSSQL с 3 столбцами
2. Реализовать загрузку данных на сервер через VBA или Python через UI. При реализации на
Python можно использовать любой UI framework
3. Сделать хранимую процедуру на MS SQL сервере для выгрузки данных за определенный
период.
4. Реализовать возможность указывать период от до (на форме VBA или значения в Excel, на
выбранной UI framework форме) и результат хранимой процедуры из 3 пункта выгружать в
новую книгу Excel. Так же реализовать форматирование отчета (закрепление шапки и
формат столбцов)
5. Отчет должен содержать столбцы: Год, Месяц, Артикул, средние продажи за год и месяц,
доля продаж артикула за выбранный период
6. Логика отчета с расчетом средних продаж и доли продаж должна быть реализована в
хранимой процедуре



-----------------------------
> [!IMPORTANT]
> Использовал Postgres SQL по тех причинам.


> [!NOTE]
> Open API в качестве UI

-----------------------------
### Создание хранимой процедуры:
```sql
CREATE OR REPLACE PROCEDURE btwdt(start_dt integer, end_dt integer)
LANGUAGE SQL
BEGIN ATOMIC
    SELECT article,count(id) FROM item WHERE dt BETWEEN start_dt AND end_dt GROUP BY article;
END;

```
### Вызов хранимой процедуры:


```sql
CALL btwdt('2021-02-04','2021-03-01')
```



